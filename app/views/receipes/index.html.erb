<p style="color: green"><%= notice %></p>
<% content_for :title, "Receipes" %>

<%= form_with(
  model: @filter_form,
  url: "",
  method: :get,
  scope: :filters,
  data: {
    turbo_frame: "receipe-table",
    controller: "auto-submit",
    auto_submit_target: "form"
  }
) do |form| %> 
  <div class="margin-bottom-10">
    <%= form.label :query, "Search receipe" %> 
  </div>
  <div>
    <%= form.search_field(
      :receipe_name,
      placeholder: "Receipe name",
      data: { auto_submit_target: "receipeInput" },
      size: 30
    ) %> 
  </div>

  <br> 
  <div data-auto-submit-target="tagsInput">
    <%= form.collection_checkboxes(:tags, @tags, :to_s, :to_s) %>
  </div>

  <br> 
  <br> 
  <br> 

  <div class="margin-bottom-10">
    <%= form.label :ingredient_query, "Search by ingredients" %> 
  </div>
  <div>
    <%= form.text_area(
      :ingredients,
      placeholder: "Add a comma between ingredients",
      data: { auto_submit_target: "ingredientInput" },
      size: "30x5"
    ) %> 
  </div>
<% end %> 

<%= turbo_frame_tag "receipe-table" do %> 
  <div class="govuk-grid-row">
    <% @filter_form.filtered_receipes.each do |receipe| %>
      <div class="govuk-grid-column-one-third">
        <%= link_to receipe_path(receipe), class: 'no-underline', data: { turbo_frame: "_top" } do %>
          <div>
            <% if receipe.image.attached? %> 
              <%= image_tag url_for(receipe.image) %>
            <% end %> 
            <h2 class="govuk-heading-m"><%= receipe.name %></h2>
          </div>
        <% end %> 
      </div>
    <% end %>
  </div>
<% end %> 

<%= govuk_link_to "New receipe", new_receipe_path %>
